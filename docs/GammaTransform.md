# 伽马变换功能说明

## 功能概述
伽马变换（Gamma Transform）是一种非线性灰度变换方法，用于调整图像的亮度和对比度。它特别适用于校正过亮或过暗的图像。

## 数学原理
伽马变换的公式为：

```
Dst = 255 × (Src / 255)^γ
```

其中：
- `Src`：输入像素值（0-255）
- `Dst`：输出像素值（0-255）
- `γ`（gamma）：伽马值

## 伽马值的效果

### γ < 1：提亮图像
- 增强暗部细节
- 适用于欠曝光的图像
- 典型值：0.4, 0.67

### γ = 1：线性变换
- 图像不改变
- 相当于恒等变换

### γ > 1：压暗图像
- 增强亮部细节
- 适用于过曝光的图像
- 典型值：1.5, 2.5

## 使用方法

### 1. 打开图像
通过"文件操作" -> "打开图像"加载一张灰度图像。

### 2. 执行伽马变换
点击菜单：**高级操作 -> 灰度变换 -> 伽马变换**

### 3. 参数设置

#### 预设模式
对话框提供了多个预设值供快速选择：
- **增强暗部** (γ = 0.4)：大幅提亮，适合严重欠曝的图像
- **提亮图像** (γ = 0.67)：中度提亮
- **线性** (γ = 1.0)：不改变图像
- **压暗图像** (γ = 1.5)：中度压暗
- **增强亮部** (γ = 2.5)：大幅压暗，适合过曝的图像

#### 自定义模式
选择"自定义"后，可以通过滑块精确调整伽马值（范围：0.1 - 3.0）

### 4. 查看直方图
对话框右侧会显示当前图像的直方图，帮助判断图像的亮度分布。

### 5. 确认应用
点击"确定"按钮应用变换，变换后的图像会添加到操作历史中。

## 实现细节

### 核心代码位置
- **接口定义**：`IBasicOperatorService.GammaTransform()`
- **实现**：`BasicOperatorService.GammaTransform()`
- **ViewModel命令**：`BasicPageViewModel.GammaTransformCommand`
- **对话框**：`GammaTransformDialog.xaml` / `GammaTransformDialog.xaml.cs`

### 算法实现
使用查找表（LUT）方法实现伽马变换，性能高效：

```csharp
var lutBytes = new byte[256];
for (var i = 0; i < 256; i++)
{
    var normalized = i / 255.0;
    var corrected = Math.Pow(normalized, gamma);
    lutBytes[i] = (byte)Math.Clamp(corrected * 255.0, 0, 255);
}
```

## 与其他灰度变换的对比

| 变换方法 | 特点 | 适用场景 |
|---------|------|---------|
| **线性灰度变换** | 线性映射，拉伸对比度 | 对比度不足的图像 |
| **分段线性变换** | 分段调整，灵活性高 | 需要精细控制的场景 |
| **伽马变换** | 非线性，专注亮度调整 | 曝光问题的图像 |
| **直方图均衡化** | 自动优化分布 | 通用对比度增强 |

## 注意事项
1. 伽马变换仅适用于**灰度图像**（单通道），彩色图像需先转换
2. 伽马值必须大于 0
3. 建议先查看直方图，判断图像的亮度分布再选择合适的伽马值
4. 过度的伽马变换可能导致细节丢失

## 示例效果

### 提亮暗图像 (γ = 0.5)
- 暗部区域显著提亮
- 灰度分布向高亮度区域移动
- 适合夜景、阴影图像

### 压暗亮图像 (γ = 2.0)
- 亮部区域显著压暗
- 灰度分布向低亮度区域移动
- 适合过曝、高光图像
